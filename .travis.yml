# https://loiane.com/2017/09/continuous-integration-with-angular-cli-travis-ci-firebase-greenkeeper-github/
# https://caveofcode.com/2017/05/publish-an-angular-app-to-github-pages/amp/

# https://medium.com/@cpavnn/deploy-to-firebase-hosting-from-github-3772fed05e72
# https://coryrylan.com/blog/deploy-angular-cli-apps-to-firebase

language: node_js

node_js:
   - node # will use latest node

branches:
    only:
      - prototype
      - master
# +    - /^greenkeeper/.*$/

cache:
  directories:
    - node_modules

before_script: # commands to run before the build step
#   - npm install -g --silent @angular/cli
#   - npm install -g @angular/cli
#   - npm install --save @angular/material @angular/cdk
#   - npm install --save @angular/animations
   - npm install

script: # the build step
#   - npm run build.prod
   - ng build --prod --base-href "https://physikonline-ffm.github.io/tinyGU/"

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN # Set in travis-ci.org dashboard
  local_dir: dist
  on:
#    branch: master
    all_branches: true

notifications:
  email: false
  slack: # <USER>:<TOKEN>#<CHANNEL>
    rooms:
      # https://travis-encrypt.github.io/
      # travis encrypt "<account>:<token>" --add notifications.slack -r accountName/repoName
      # travis encrypt "<account>:<token>#channel" --add notifications.slack.rooms
      secure: "ObvimdNiDdb5NURHdyVfNN4VqWRxVM4EWsVkf7saPAH754yg2lYEnaKPqflUsbwpgpHzafsikRSR5t9bjs6JmilR6W1tTxNrbqNZWuQobv+tqMJFuWBbAVjCjlEjPiuK3ULxl+ekXSAhz0mXFweyrDpmA78OSvJY1d+fa3DqvdANQhHC/pAm3Lt20Nih4O06rIEnEbGobjELOIRaN5HmxEZcvoC+UDcMcRRoLLJBUPHyNxrvYiKYezrua+1wwAmA30aE/4Nr0v3Xzx/obieWgem0zvlsCpIhXIyyjQ7F3p9/IHImToGGouGj3ThQXE9N7wYujQuFXb0sSUEWBfucALPein4kEZfmsvF7nYlPjKfasl8f0sevg8UtDqpgBpzhwZZNJWIrDr46gIKIXNaYS8XHLeP1pXWKEgWPG5su93K6U0Az5YSJbaRkA4Peg2ZMOeLAf9iYiNEdkIsnVo+xPsBxk6A0K+vQrWEvBdfHIoUJeg8Lpxcr3A2dKgLTbMNUWJIMLBGHBCRD2E9aJ5s9hY2fGSBAenaoElSlhhlp5oHT+n3eabECLtutWzME6ROW5RAKc/K+1cuz7qJArjaoXQby1V5Jb/K7B1BwZgvKb2xmJMzy15VBURHVZioF16s+P05RY+rbRrx/ZajaQsMo9IhEcY8o6zEu18CbvwYr/Wo="
      on_start: always
      on_failure: always
      on_success: always
