# https://loiane.com/2017/09/continuous-integration-with-angular-cli-travis-ci-firebase-greenkeeper-github/
# https://caveofcode.com/2017/05/publish-an-angular-app-to-github-pages/amp/

# https://medium.com/@cpavnn/deploy-to-firebase-hosting-from-github-3772fed05e72
# https://coryrylan.com/blog/deploy-angular-cli-apps-to-firebase

language: node_js

node_js:
   - node # will use latest node

branches:
    only:
      - prototype
      - master
# +    - /^greenkeeper/.*$/

cache:
  directories:
    - node_modules

before_script: # commands to run before the build step
   - npm install -g --silent @angular/cli
   - npm install -g @angular/cli
   - npm install --save @angular/material @angular/cdk
#   - npm install --save @angular/animations
   - npm install

script: # the build step
#   - npm run build.prod
   - ng build --prod --base-href "https://physikonline-ffm.github.io/tinyGU/"

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN # Set in travis-ci.org dashboard
  local_dir: dist
  on:
#    branch: master
    all_branches: true

notifications:
  email: false
  slack: # <USER>:<TOKEN>#<CHANNEL>
    rooms:
      # encrypt with http://travis-encrypt.github.io/
      secure: "1C4mQOvNu7wwbWcDbvCc501AoTC3drs7hSRBdOrbYZk/tN6+cKO47IgmFgQZ5japv+hlxTRoxhvRoKP6BkBO/mf2oOCD3XyECW3WrCwXvuMSqomhgeBa9fUI/cF8Ah5eGflpLXV9kk6jKyocEGSdwBPho7Ox0Teq/s7HyFupvXFyl5LHgKDlOe3m6JrIIIxGm9c3Dh4nC+fzT4Pps1F/LgbGCewC3v/AiXts8+2TOkCksAu7K4cEcpiVJXz6p7z1BZdyLiX8KTX/TAZZDNpVvSM5QqsBN/sk+vkVsgUTFgqUVsQePs/d2xOzWOgTeEIUKZCaULMadJ5C1VoapfiXI7kl2068eWxbRQ+QnAyHiaDp84J+ycfVrGUVTOr8cpbHVz7nAyWoyiLzsaAnYZ0r15n8p1RTp+5UXgIJMzXiN8Iz2NbO2Fo9zUk8BF6Cfv+TuALsLxtFostFS1de4jQGsamdwAIhfUYOPrTMqrWVFXRUB9g6vfWFWqdZ8VE/e8Ibf7b2BJy1B1u7ot4k2O0AmJ4iiKXHrhWPL1WIjB7JWXwLnLFnJRwLwx32saLcEf9mHpizHBaHqGERqxDTkj1xOf/owgezMCbN2IcKme3VPXb3+3dqBg58uTAxxZ9UjGYUS2g4xu7fRlEcIxfwPCVEKB54DXsxMDTZkKQ2B6XXO50="
      on_start: always
      on_failure: always
      on_success: always
